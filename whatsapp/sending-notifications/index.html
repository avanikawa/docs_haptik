<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Setup · Haptik Docs</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="As explained in the `Types of Conversations` section, you can have the bot initiate a conversation with the user. This is done by sending them a pre-approved message template."/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Setup · Haptik Docs"/><meta property="og:type" content="website"/><meta property="og:url" content="https://docs.haptik.ai/"/><meta property="og:description" content="As explained in the `Types of Conversations` section, you can have the bot initiate a conversation with the user. This is done by sending them a pre-approved message template."/><meta property="og:image" content="https://docs.haptik.ai/img/image_0.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://docs.haptik.ai/img/image_0.png"/><meta name="robots" content="noindex"/><link rel="shortcut icon" href="/img/image_0.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-106563119-6', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="/js/index.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/image_0.png" alt="Haptik Docs"/><h2 class="headerTitleWithLogo">Haptik Docs</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="/#tools" target="_self">Tools</a></li><li class=""><a href="/#integrations" target="_self">Integrations</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Notifications (HSMs)</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Introduction</h3><ul class=""><li class="navListItem"><a class="navItem" href="/whatsapp/">Getting Started</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Setting up WhatsApp</h3><ul class=""><li class="navListItem"><a class="navItem" href="/whatsapp/setup-wa">Setting up WhatsApp Account</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Building WhatsApp IVA</h3><ul class=""><li class="navListItem"><a class="navItem" href="/whatsapp/cs-wa">Using Conversation Studio</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Notifications (HSMs)</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/whatsapp/sending-notifications">Setup</a></li><li class="navListItem"><a class="navItem" href="/whatsapp/allowed-notification-types">Allowed Notification Types</a></li><li class="navListItem"><a class="navItem" href="/whatsapp/disallowed-notification-types">Disallowed Notification Types</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Miscellaneous</h3><ul class=""><li class="navListItem"><a class="navItem" href="/whatsapp/getting-user-opt-ins">Getting User Opt-Ins</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Setup</h1></header><article><div><span><p>As explained in the <code>Types of Conversations</code> section, you can have the bot initiate a conversation with the user. This is done by sending them a pre-approved message template.</p>
<h2><a class="anchor" aria-hidden="true" id="highly-structured-message-hsm-templates"></a><a href="#highly-structured-message-hsm-templates" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Highly Structured Message (HSM) Templates</h2>
<p>The templates that can be sent to WhatsApp users are called Highly Structured Messages. In short they are often referred to as HSMs.</p>
<p>A HSM is a template message with placeholders for dynamic data. All HSMs need to be approved by WhatsApp before they can be sent to the user.</p>
<h2><a class="anchor" aria-hidden="true" id="setting-up-a-hsm"></a><a href="#setting-up-a-hsm" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Setting up a HSM</h2>
<p>To setup a HSM you first need to get access to the FB Business Manager Tool of the business. If you don't already have access, you can request it by sending an email to <code>platform@haptik.ai</code> with the subject as <code>Request access to FB Business Manager</code> and in the body mention the business and the reason for access request.</p>
<p>Once you have access, you can go to the Message Templates section of the business manager tool and create your HSM.</p>
<p><img src="/assets/message_templates_home.png" alt="Message Template Home"></p>
<p>On the <code>Message Templates</code> page click on the <strong>Create Message Template</strong> button to create a new template.</p>
<p><img src="/assets/create_message_template.gif" alt="Creating a template"></p>
<p>The steps involved in creating a HSM template are:</p>
<ol>
<li>Set the name of the template.</li>
<li>Choose the category of template. You can read more about the allowed categories in the next section.</li>
<li>Select the language of the template. For a given template type, you can have multipe language versions of it.</li>
<li>Insert the content of the template. Inside the content you can use rich text elements like <code>Bold</code>, <code>Italics</code> etc and you can also insert variables in it.</li>
<li>Once satisfied, click on submit to submit the HSM for approval.</li>
</ol>
<blockquote>
<p><strong>NOTE:</strong> Once approved, the HSM content cannot be edited.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="adding-buttons-to-hsm-templates"></a><a href="#adding-buttons-to-hsm-templates" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding buttons to HSM templates</h3>
<p>WhatsApp allows buttons to be added to the HSM template. The <code>Buttons</code> section is located at the bottom of the HSM page (assuming that you are either creating a new HSM or editing an existing one). There are two broad categories of buttons that you can add to your template:</p>
<ol>
<li>Quick Reply</li>
<li>Call To Action</li>
</ol>
<p><strong>Quick Reply:</strong> <br/>
An HSM template can have at the most 3 quick reply buttons. Quick Reply buttons as their name implies, are buttons which when tapped-on by the user, send the title of those buttons as a message from that user. <em>(You can even provide a payload to override the message that gets sent back on button click. More on that later, in sending HSM Templates section)</em></p>
<blockquote>
<p>Known limitations:</p>
<ul>
<li>At most 3 quick reply Buttons</li>
<li>Text of Each button can be no more than 20 characters</li>
</ul>
</blockquote>
<p><em>Steps to add Quick Reply buttons:</em></p>
<ul>
<li>In the <code>Buttons</code> section, click the dropdown which by default is set to <code>None</code> and choose <code>Quick Reply</code></li>
<li>A new input field titled <code>Button Text</code> will appear</li>
<li>Enter the text which is to be shown in the Quick Reply</li>
<li>To add more buttons, click on <code>Add Another Button</code> and repeat the above step</li>
<li>Once you save your HSM template, this configuration gets stored along with it.</li>
</ul>
<ul>
<li><img src="/assets/hsm_buttons/quick-replies.png" alt="Quick Reply buttons in HSM template"> <br/> <em>Quick Reply buttons in HSM template builder</em> <br/><br/></li>
</ul>
<ul>
<li><img src="/assets/hsm_buttons/whatsapp_quick-replies.jpg" alt="Quick Reply buttons in users Whatsapp Messenger"> <br/> <em>Quick Reply buttons in users Whatsapp Messenger</em></li>
</ul>
<p><br/></p>
<p><strong>Call To Action:</strong> <br/>
A Call To Action button as the name implies, is a button which when clicked by the user would cause a certain action to be called or performed right on the user's device.</p>
<p>Call To Action buttons are further divided into two types:-</p>
<ul>
<li>Call Phone number</li>
<li>Visit Website</li>
</ul>
<blockquote>
<p>Known limitations:</p>
<ul>
<li>Max two buttons i.e. one of each type (Call Phone Number or Visit Website)</li>
<li>Text of Each button can be no more than 20 characters</li>
</ul>
</blockquote>
<p><em>Steps to add Call To Action buttons:</em></p>
<ul>
<li>In the <code>Buttons</code> section, click the dropdown which by default is set to <code>None</code> and choose <code>Call To Action</code>.</li>
</ul>
<ul>
<li><em>Call Phone Number</em>:
<ul>
<li>This button takes a phone number with country code and text to display on the button as parameters and when sent to the user, this button on click will actually initiate a phone call to the said number.</li>
<li>When <code>Call Phone Number</code> is selected in <code>Type of Action</code> you get the following columns adjacent to it viz. <code>Button Text</code>, <code>Country</code>, <code>Phone Number</code>.</li>
</ul></li>
</ul>
<ul>
<li><em>Visit Website</em>:
<ul>
<li>This button takes a website URL and text to display on the button as parameters and when sent to the user, this button on click will actually launch the website in the user's phone.</li>
<li>When <code>Visit Website</code> is selected in <code>Type of Action</code> you get the following columns adjacent to it viz. <code>Button Text</code>, <code>URL Type</code>, <code>Website URL</code>.</li>
<li><code>URL Type</code> is a drop down in itself which has two options viz. <code>Static</code> and <code>Dynamic</code></li>
<li>A <code>Static</code> URL is self explanatory. It is basically a hardcoded website URL.</li>
<li>A <code>Dynamic</code> URL is a URL that will have a parameter which will be suffixed to it to form the final URL. <br/> For example, if the URL entered for Dynamic field is <code>https://&lt;sitedomain&gt;.com</code>, then while sending HSM, a paramter will have to be sent which will be suffixed to this URL. Thus, if you send the parameter as <code>1234</code> then when the user receives this HSM and clicks on this button, the URL launched would be <code>https://&lt;sitedomain&gt;.com/1234</code>.</li>
<li>Do note that sending the parameter for <code>Dynamic</code> URL in the HSM while sending request is mandatory.</li>
</ul></li>
</ul>
<ul>
<li><img src="/assets/hsm_buttons/call-to-action-button.png" alt="Call To Action buttons in HSM template"> <br/> <em>Call To Action buttons in HSM template builder</em> <br/><br/></li>
</ul>
<ul>
<li><img src="/assets/hsm_buttons/whatsapp_call-to-action.jpg" alt="Call To Action buttons in user's WhatsApp Messenger"> <br/> <em>Call To Action buttons in user's WhatsApp Messenger</em></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="sending-a-hsm-as-a-notification"></a><a href="#sending-a-hsm-as-a-notification" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sending a HSM as a notification</h2>
<p>After you have submitted your HSM and approval has been granted, you can start sending the HSM as notifications to opted-in users.</p>
<p>You can do this by making a <code>POST</code> request to the notification endpoint provided to you by the <code>DevOps/Platform</code> team.</p>
<blockquote>
<p><strong>NOTE:</strong> The  older version of send notification API (<code>/whatsapp/notification/</code>) is now deprecated in favor of <code>/whatsapp/notification/v2/</code> of the same API.</p>
</blockquote>
<p>The request signature is as below:</p>
<pre><code class="hljs css language-bash">curl -X POST \
  &lt;base_url&gt;/whatsapp/notification/v2/ \
  -H <span class="hljs-string">'Authorization: Bearer &lt;token&gt;'</span> \
  -H <span class="hljs-string">'Content-Type: application/json'</span> \
  -H <span class="hljs-string">'client-id: &lt;client-id&gt;'</span> \
  -d <span class="hljs-string">'{
    "business_id": &lt;business_id as a number&gt;,
    "to": "&lt;phone_number&gt;",
    "type": "hsm",
    "hsm": {
        "namespace": "&lt;from whatsapp dashboard&gt;",
        "element_name": "&lt;from whatsapp dashboard&gt; ",
        "language": {
            "policy": "deterministic",
            "code": "en_US"
        },
        "localizable_params": [
            {"default": "Param 1 value"},
            {"default": "Param 2 value"}
        ]
    }
}
'</span>
</code></pre>
<p>In the request body, <code>business_id</code>, <code>token</code> and <code>client_id</code> will be provided by Haptik.</p>
<p>If the number does not exist on WhatsApp you will get the below message as response body:</p>
<pre><code class="hljs">{
    <span class="hljs-attr">"error_message"</span>: <span class="hljs-string">"unable to verify contact details"</span>
}
</code></pre>
<p>When API call is successful you will get the below but does not mean message was delivered but Notifications API was triggered and WhatsApp sent the message to defined number. Sent vs Delivered messages only stats are available on WhatsApp dashboard.</p>
<pre><code class="hljs">{
   <span class="hljs-attr">"meta"</span> : {
      <span class="hljs-attr">"api_status"</span> : <span class="hljs-string">"stable"</span>,
      <span class="hljs-attr">"version"</span> : <span class="hljs-string">"2.25.1"</span>
   },
   <span class="hljs-attr">"messages"</span> : [
      {
         <span class="hljs-attr">"id"</span> : <span class="hljs-string">"&lt;random message id&gt;"</span>
      }
   ]
}
</code></pre>
<p>In case of any other errors if returned by WhatsApp, they will be returned as it is with the corresponding status codes. You can refer <a href="https://developers.facebook.com/docs/whatsapp/api/messages/message-templates/#response">this</a> for reference.</p>
<p>Details regarding the other fields in the body can be found <a href="https://developers.facebook.com/docs/whatsapp/message-templates/sending/">here</a>.</p>
<p>Acceptable formats for phone number can be found <a href="https://developers.facebook.com/docs/whatsapp/api/contacts#phone">here</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="sending-a-media-hsm"></a><a href="#sending-a-media-hsm" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sending a Media HSM</h2>
<p>You can not only send text based HSMs to your WhatsApp end users, but also Media HSMs, Button HSMs.</p>
<p>Checkout the examples below:</p>
<p><strong>Text HSM</strong></p>
<p><img src="/assets/1text-hsm.png" alt="Text HSM"></p>
<p>Nothing new here.</p>
<p><strong>Image HSM</strong></p>
<p><img src="/assets/2image-hsm.png" alt="Image HSM"></p>
<p>HSM sent with an image file as an attachment.</p>
<p><strong>Document HSM</strong></p>
<p><img src="/assets/3pdf-hsm.png" alt="PDF HSM"></p>
<p>HSM sent with a PDF file as an attachment.</p>
<p><strong>Video HSM</strong></p>
<p><img src="/assets/4video-hsm.png" alt="Video HSM"></p>
<p>HSM sent with a Video file as an attachment.</p>
<p>Pardon us for the text copies and images in above messages. Also, only PDF's supported. Docx files are not supported as of now.</p>
<p>How to use them:</p>
<p>Well here is a simple structure of the message used for sending Media HSM with an Image.</p>
<p>Example curl requests for Image:</p>
<pre><code class="hljs">curl -X POST \
  &lt;base_url&gt;/whatsapp/notification/v2/ \
  -H <span class="hljs-string">'Authorization: Bearer &lt;token&gt;'</span> \
  -H <span class="hljs-string">'Content-Type: application/json'</span> \
  -H <span class="hljs-string">'client-id: &lt;client-id&gt;'</span> \
  -d <span class="hljs-string">'{
    "</span>business_id<span class="hljs-string">": &lt;business_id as a number&gt;,
    "</span>to<span class="hljs-string">": "</span>&lt;phone_number&gt;<span class="hljs-string">",
    "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>template<span class="hljs-string">",
    "</span>template<span class="hljs-string">": {
        "</span>namespace<span class="hljs-string">": "</span>&lt;from whatsapp dashboard&gt;<span class="hljs-string">",
        "</span>name<span class="hljs-string">": "</span>&lt;from whatsapp dashboard&gt;<span class="hljs-string">",
        "</span>language<span class="hljs-string">": {
            "</span>policy<span class="hljs-string">": "</span>deterministic<span class="hljs-string">",
            "</span>code<span class="hljs-string">": "</span>en<span class="hljs-string">"
        },
        "</span>components<span class="hljs-string">": [
            {
                "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>header<span class="hljs-string">",
                "</span>parameters<span class="hljs-string">": [
                    {
                        "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>image<span class="hljs-string">",
                        "</span>image<span class="hljs-string">": {
                          "</span>link<span class="hljs-string">": "</span>&lt;URL of the image&gt;<span class="hljs-string">"
                        }
                    }
                ]
            },
            {
                "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>body<span class="hljs-string">",
                "</span>parameters<span class="hljs-string">": [
                {
                  "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>text<span class="hljs-string">",
                  "</span>text<span class="hljs-string">": "</span>Param Value <span class="hljs-number">1</span><span class="hljs-string">"
                }
                ]
            }
        ]
    }
}'</span>
</code></pre>
<p>Example curl requests for Document:</p>
<pre><code class="hljs">curl -X POST \
 &lt;base_url&gt;/whatsapp/notification/v2/ \
  -H <span class="hljs-string">'Authorization: Bearer &lt;token&gt;'</span> \
  -H <span class="hljs-string">'Content-Type: application/json'</span> \
  -H <span class="hljs-string">'client-id: &lt;client-id&gt;'</span> \
  -d <span class="hljs-string">'{
    "</span>business_id<span class="hljs-string">": &lt;business_id as a number&gt;,
    "</span>to<span class="hljs-string">": "</span>&lt;phone_number&gt;<span class="hljs-string">",
    "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>template<span class="hljs-string">",
    "</span>template<span class="hljs-string">": {
        "</span>namespace<span class="hljs-string">": "</span>&lt;from whatsapp dashboard&gt;<span class="hljs-string">",
        "</span>name<span class="hljs-string">": "</span>&lt;from whatsapp dashboard&gt;<span class="hljs-string">",
        "</span>language<span class="hljs-string">": {
            "</span>policy<span class="hljs-string">": "</span>deterministic<span class="hljs-string">",
            "</span>code<span class="hljs-string">": "</span>en<span class="hljs-string">"
        },
        "</span>components<span class="hljs-string">": [
            {
                "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>header<span class="hljs-string">",
                "</span>parameters<span class="hljs-string">": [
                    {
                        "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>document<span class="hljs-string">",
                        "</span>document<span class="hljs-string">": {
                          "</span>link<span class="hljs-string">": "</span>&lt;URL&gt;<span class="hljs-string">",
                          "</span>filename<span class="hljs-string">": "</span>&lt;Filename to be displayed&gt;<span class="hljs-string">"
                        }
                    }
                ]
            },
            {
                "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>body<span class="hljs-string">",
                "</span>parameters<span class="hljs-string">": [
                {
                  "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>text<span class="hljs-string">",
                  "</span>text<span class="hljs-string">": "</span>Param Value <span class="hljs-number">1</span><span class="hljs-string">"
                }
                ]
            }
        ]
    }
}'</span>

</code></pre>
<p>Example curl requests for Video:</p>
<pre><code class="hljs">curl -X POST \
  &lt;base_url&gt;/whatsapp/notification/v2/ \
  -H <span class="hljs-string">'Authorization: Bearer &lt;token&gt;'</span> \
  -H <span class="hljs-string">'Content-Type: application/json'</span> \
  -H <span class="hljs-string">'client-id: &lt;client-id&gt;'</span> \
  -d <span class="hljs-string">'{
    "</span>business_id<span class="hljs-string">": &lt;business_id as a number&gt;,
    "</span>to<span class="hljs-string">": "</span>&lt;phone_number&gt;<span class="hljs-string">",
    "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>template<span class="hljs-string">",
    "</span>template<span class="hljs-string">": {
        "</span>namespace<span class="hljs-string">": "</span>&lt;from whatsapp dashboard&gt;<span class="hljs-string">",
        "</span>name<span class="hljs-string">": "</span>&lt;from whatsapp dashboard&gt;<span class="hljs-string">",
        "</span>language<span class="hljs-string">": {
            "</span>policy<span class="hljs-string">": "</span>deterministic<span class="hljs-string">",
            "</span>code<span class="hljs-string">": "</span>en<span class="hljs-string">"
        },
        "</span>components<span class="hljs-string">": [
            {
                "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>header<span class="hljs-string">",
                "</span>parameters<span class="hljs-string">": [
                    {
                        "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>video<span class="hljs-string">",
                        "</span>video<span class="hljs-string">": {
                          "</span>link<span class="hljs-string">": "</span>&lt;URL of the Video&gt;<span class="hljs-string">"
                        }
                    }
                ]
            },
            {
                "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>body<span class="hljs-string">",
                "</span>parameters<span class="hljs-string">": [
                {
                  "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>text<span class="hljs-string">",
                  "</span>text<span class="hljs-string">": "</span>Param Value <span class="hljs-number">1</span><span class="hljs-string">"
                }
                ]
            }
        ]
    }
}'</span>

</code></pre>
<p>Note: The above structure is for reference only and will change based on the way we create HSM on Whatsapp Business Manager and for each media type.</p>
<blockquote>
<p>Only Images, PDF, MP3 and MP4 files are supported.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="sending-hsms-with-buttons"></a><a href="#sending-hsms-with-buttons" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sending HSMs with Buttons</h2>
<p><a href="https://developers.facebook.com/docs/whatsapp/api/messages/message-templates/interactive-message-templates">Link to the official documentation.</a></p>
<p><strong>Quick Reply:</strong></p>
<ul>
<li>Sending a HSM template with Quick Replies is similar to sending any other HSM template.</li>
<li>The only difference is when you would like to send a payload with the template.</li>
<li>What is a <em>payload</em> in Quick Reply?
<ul>
<li><em>payload</em> is information you would like to send back to the Haptik API when a Quick Reply button is clicked.</li>
<li>For instance, in our above example we have a template which sends two Quick Reply buttons viz, <code>Yes</code> and <code>No</code>.</li>
<li>Let's say when the HSM is sent to the user, the button <code>Yes</code> is configured without any payload, but the button <code>No</code> has a <em>payload</em> <code>No, I did not receive the order</code>.</li>
<li>Now, inside the WhatsApp Messenger, if the user clicks on <code>Yes</code>, the reply sent to Haptik API will be <code>Yes</code>.</li>
<li>However, if the user clicks on <code>No</code>, the reply sent back to Haptik API will be <code>No, I did not receive the order</code> i.e. the payload will be sent back.</li>
</ul></li>
</ul>
<p>Sample CURL request for sending payload for Quick Reply. <em>(Note how index is used to target specific buttons)</em></p>
<p><code>index</code>: <em>Zero based index</em> to appropriately target the button for which you are sending the param. For instance, if you are sending the payload for your second button then the value of <code>index</code> would be <code>1</code></p>
<pre><code class="hljs">curl -X POST &lt;base_url&gt;/whatsapp/notification/v2/ \
-H <span class="hljs-string">'client-id: &lt;client-id&gt;'</span> \
-H <span class="hljs-string">'Authorization: Bearer &lt;token&gt;'</span> \
-H <span class="hljs-string">'Content-Type: application/json'</span> \
-d <span class="hljs-string">'{
  "</span>business_id<span class="hljs-string">": &lt;ID of the business&gt;,
  "</span>to<span class="hljs-string">": "</span>&lt;phone number&gt;<span class="hljs-string">",
  "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>template<span class="hljs-string">",
  "</span>template<span class="hljs-string">": {
    "</span>namespace<span class="hljs-string">": "</span>&lt;from whatsapp dashboard&gt;<span class="hljs-string">",
    "</span>name<span class="hljs-string">": "</span>&lt;name of the template&gt;<span class="hljs-string">",
    "</span>language<span class="hljs-string">": {
      "</span>policy<span class="hljs-string">": "</span>deterministic<span class="hljs-string">",
      "</span>code<span class="hljs-string">": "</span>en<span class="hljs-string">"
    },
    "</span>components<span class="hljs-string">": [
      {
        "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>button<span class="hljs-string">",
        "</span>sub_type<span class="hljs-string">": "</span>quick_reply<span class="hljs-string">",
        "</span>index<span class="hljs-string">": "</span><span class="hljs-number">1</span><span class="hljs-string">",
        "</span>parameters<span class="hljs-string">": [{
          "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>payload<span class="hljs-string">",
          "</span>payload<span class="hljs-string">": "</span>No, I did not receive the order<span class="hljs-string">"
        }]
      }
    ]
  }
}
'</span>
</code></pre>
<p><strong>Call To Action:</strong></p>
<ul>
<li>Sending a HSM template with Call To Action buttons is similar to sending any other HSM template.</li>
<li>The only difference is when you would like to send a parameter to the dynamic URL.</li>
<li>Do note that the paramter sent to the dynamic URL should be a URL safe string, since it would be appended at the end of the base_URL provided in the HSM builder template <em>(Please refer to the earlier sections for detailed explanation)</em>.</li>
</ul>
<p>Sample CURL request for sending parameter for dynamic URL. <em>(Note how index is used to target the dynamic URL button)</em></p>
<p><code>index</code>: <em>Zero based index</em> to appropriately target the button for which you are sending the param. For instance, if you are sending the dynamic URL param for your second button then the value of <code>index</code> would be <code>1</code></p>
<pre><code class="hljs">curl -X POST &lt;base_url&gt;/whatsapp/notification/v2/ \
-H <span class="hljs-string">'client-id: &lt;client-id&gt;'</span> \
-H <span class="hljs-string">'Authorization: Bearer &lt;token&gt;'</span> \
-H <span class="hljs-string">'Content-Type: application/json'</span> \
-d <span class="hljs-string">'{
  "</span>business_id<span class="hljs-string">": &lt;ID of the business&gt;,
  "</span>to<span class="hljs-string">": "</span>&lt;phone number&gt;<span class="hljs-string">",
  "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>template<span class="hljs-string">",
  "</span>template<span class="hljs-string">": {
    "</span>namespace<span class="hljs-string">": "</span>&lt;from whatsapp dashboard&gt;<span class="hljs-string">",
    "</span>name<span class="hljs-string">": "</span>&lt;name of the template&gt;<span class="hljs-string">",
    "</span>language<span class="hljs-string">": {
      "</span>policy<span class="hljs-string">": "</span>deterministic<span class="hljs-string">",
      "</span>code<span class="hljs-string">": "</span>en<span class="hljs-string">"
    },
    "</span>components<span class="hljs-string">": [
      {
        "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>button<span class="hljs-string">",
        "</span>sub_type<span class="hljs-string">": "</span>url<span class="hljs-string">",
        "</span>index<span class="hljs-string">": "</span><span class="hljs-number">1</span><span class="hljs-string">",
        "</span>parameters<span class="hljs-string">": [{
          "</span><span class="hljs-built_in">type</span><span class="hljs-string">": "</span>text<span class="hljs-string">",
          "</span>text<span class="hljs-string">": "</span><span class="hljs-number">445566</span><span class="hljs-string">"
        }]
      }
    ]
  }
}
'</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="faqs"></a><a href="#faqs" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>FAQs</h2>
<p>I keep getting <code>&quot;unable to verify contact details&quot;</code> in response even though the Mobile Number entered is a valid WhatsApp account.</p>
<blockquote>
<p>This could happen because of the following reasons:</p>
<ul>
<li>If the credentials entered in Mogambo's Business Manager are incorrect.</li>
<li>If you have not specified the Country code in the <code>to</code> field when sending the HSM and if it is different from the Country Code used when setting up the WhatsApp Number.</li>
</ul>
</blockquote>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 4/16/2021</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/whatsapp/cs-wa"><span class="arrow-prev">← </span><span>Using Conversation Studio</span></a><a class="docs-next button" href="/whatsapp/allowed-notification-types"><span>Allowed Notification Types</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#highly-structured-message-hsm-templates">Highly Structured Message (HSM) Templates</a></li><li><a href="#setting-up-a-hsm">Setting up a HSM</a><ul class="toc-headings"><li><a href="#adding-buttons-to-hsm-templates">Adding buttons to HSM templates</a></li></ul></li><li><a href="#sending-a-hsm-as-a-notification">Sending a HSM as a notification</a></li><li><a href="#sending-a-media-hsm">Sending a Media HSM</a></li><li><a href="#sending-hsms-with-buttons">Sending HSMs with Buttons</a></li><li><a href="#faqs">FAQs</a></li></ul></nav></div><footer class="nav-footer" id="footer"><div class="footer"><a href="https://haptik.ai/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/image_0.png" alt="Haptik Inc." width="100"/></a><div class="footer-columns"><div class="footer-column"><div class="footer-column-title">Tools</div><div class="footer-column-links"><a href="https://docs.haptik.ai/bot-builder/basic/introduction" class="footer-column-link">Conversation Studio</a><a href="https://docs.haptik.ai/agent-chat/" class="footer-column-link">Smart Agent Chat</a><a href="https://docs.haptik.ai/bot-analytics/" class="footer-column-link">Intelligent Analytics</a></div></div><div class="footer-column"><div class="footer-column-title">Integrations</div><div class="footer-column-links"><a href="https://docs.haptik.ai/ios-sdk/" class="footer-column-link">iOS SDK</a><a href="https://docs.haptik.ai/android-sdk/" class="footer-column-link">Android SDK</a><a href="https://docs.haptik.ai/web-sdk/" class="footer-column-link">Web SDK</a><a href="https://docs.haptik.ai/whatsapp/" class="footer-column-link">WhatsApp</a><a href="https://docs.haptik.ai/other/facebook" class="footer-column-link">Facebook</a><a href="https://docs.haptik.ai/webhooks/" class="footer-column-link">Bot API</a></div></div><div class="footer-column"><div class="footer-column-title">Others</div><div class="footer-column-links"><a href="https://docs.haptik.ai/hsl/" class="footer-column-link">HSL</a><a href="https://docs.haptik.ai/other/sla" class="footer-column-link">SLA</a><a href="https://docs.haptik.ai/external-chat-tool/" class="footer-column-link">External Agent Chat Tool</a></div></div></div><div class="footer-copyright"></div></div><section class="copyright">Copyright © 2021 Haptik Inc.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '224c7079e67e84a978d8b4621f6af16d',
                indexName: 'haptik',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>